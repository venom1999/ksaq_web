(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71ea83d7"],{"268f":function(t,e,s){t.exports=s("fde4")},"2cdc":function(t,e,s){"use strict";var i=s("2b0e");e["a"]=new i["default"]},"2f21":function(t,e,s){"use strict";var i=s("79e5");t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},"32a6":function(t,e,s){var i=s("241e"),a=s("c3a1");s("ce7e")("keys",function(){return function(t){return a(i(t))}})},"454f":function(t,e,s){s("46a7");var i=s("584a").Object;t.exports=function(t,e,s){return i.defineProperty(t,e,s)}},"46a7":function(t,e,s){var i=s("63b6");i(i.S+i.F*!s("8e60"),"Object",{defineProperty:s("d9f6").f})},"55dd":function(t,e,s){"use strict";var i=s("5ca1"),a=s("d8e8"),l=s("4bf8"),n=s("79e5"),r=[].sort,o=[1,2,3];i(i.P+i.F*(n(function(){o.sort(void 0)})||!n(function(){o.sort(null)})||!s("2f21")(r)),"Array",{sort:function(t){return void 0===t?r.call(l(this)):r.call(l(this),a(t))}})},"5df3":function(t,e,s){"use strict";var i=s("02f4")(!0);s("01f9")(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,s=this._i;return s>=e.length?{value:void 0,done:!0}:(t=i(e,s),this._i+=t.length,{value:t,done:!1})})},"85f2":function(t,e,s){t.exports=s("454f")},"8aae":function(t,e,s){s("32a6"),t.exports=s("584a").Object.keys},"8bd7":function(t,e,s){"use strict";var i=s("9453"),a=s.n(i);a.a},9453:function(t,e,s){},a4bb:function(t,e,s){t.exports=s("8aae")},bf90:function(t,e,s){var i=s("36c3"),a=s("bf0b").f;s("ce7e")("getOwnPropertyDescriptor",function(){return function(t,e){return a(i(t),e)}})},ce7e:function(t,e,s){var i=s("63b6"),a=s("584a"),l=s("294c");t.exports=function(t,e){var s=(a.Object||{})[t]||Object[t],n={};n[t]=e(s),i(i.S+i.F*l(function(){s(1)}),"Object",n)}},cebc:function(t,e,s){"use strict";var i=s("268f"),a=s.n(i),l=s("e265"),n=s.n(l),r=s("a4bb"),o=s.n(r),c=s("85f2"),u=s.n(c);function d(t,e,s){return e in t?u()(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function v(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{},i=o()(s);"function"===typeof n.a&&(i=i.concat(n()(s).filter(function(t){return a()(s,t).enumerable}))),i.forEach(function(e){d(t,e,s[e])})}return t}s.d(e,"a",function(){return v})},e265:function(t,e,s){t.exports=s("ed33")},ec28:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[s("el-header",{attrs:{height:"48px"}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[t._v("安全风险分级评估")])],1)],1),s("div",{staticClass:"wrapper"},[s("div",{staticClass:"content"},[s("div",{staticClass:"section"},[s("div",{staticClass:"list-filter"},[s("el-row",{staticStyle:{"margin-bottom":"15px"}},[s("el-col",{attrs:{span:7}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                  "+t._s(t.params[0].label)+"\n                ")]),s("el-col",{attrs:{span:16}},[s("el-select",{attrs:{filterable:"",clearable:""},model:{value:t.params[0].value,callback:function(e){t.$set(t.params[0],"value",e)},expression:"params[0].value"}},t._l(t.sectionList.filter(function(t){return 1===t.level&&!t.archivedTime}),function(t,e){return s("el-option",{key:e,attrs:{value:t.sectionID,label:t.sectionName}})}),1)],1)],1),s("el-col",{attrs:{span:7}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                  "+t._s(t.params[1].label)+"\n                ")]),s("el-col",{attrs:{span:16}},[s("el-select",{attrs:{filterable:"",clearable:""},model:{value:t.params[1].value,callback:function(e){t.$set(t.params[1],"value",e)},expression:"params[1].value"}},t._l(t.sectionList.filter(function(t){return 3===t.level&&!t.archivedTime}),function(t,e){return s("el-option",{key:e,attrs:{value:t.sectionID,label:t.sectionName}})}),1)],1)],1),s("el-col",{attrs:{span:7}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                  "+t._s(t.params[2].label)+"\n                ")]),s("el-col",{attrs:{span:16}},[s("el-input",{attrs:{clearable:""},model:{value:t.params[2].value,callback:function(e){t.$set(t.params[2],"value",e)},expression:"params[2].value"}})],1)],1),s("el-col",{attrs:{span:2}},[s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.filter}},[t._v("查 询")])],1)],1),s("el-row",[s("el-col",{attrs:{span:7}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                  "+t._s(t.params[3].label)+"\n                ")]),s("el-col",{attrs:{span:16}},[s("el-date-picker",{attrs:{type:"daterange",clearable:""},model:{value:t.params[3].value,callback:function(e){t.$set(t.params[3],"value",e)},expression:"params[3].value"}})],1)],1),s("el-col",{attrs:{span:7}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                  "+t._s(t.params[4].label)+"\n                ")]),s("el-col",{attrs:{span:16}},[s("el-date-picker",{attrs:{type:"daterange",clearable:""},model:{value:t.params[4].value,callback:function(e){t.$set(t.params[4],"value",e)},expression:"params[4].value"}})],1)],1),s("el-col",{attrs:{span:7}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                  "+t._s(t.params[5].label)+"\n                ")]),s("el-col",{attrs:{span:16}},[s("el-select",{attrs:{filterable:"",clearable:""},model:{value:t.params[5].value,callback:function(e){t.$set(t.params[5],"value",e)},expression:"params[5].value"}},[s("el-option",{attrs:{value:"0",label:"未归档"}}),s("el-option",{attrs:{value:"1",label:"已归档"}})],1)],1)],1)],1)],1)]),s("div",{staticClass:"section"},[s("div",{staticClass:"list-operation"},[t.userRightEditable?s("el-button",{staticClass:"operation-editable",attrs:{type:"primary"},on:{click:t.showAddDialog}},[t._v("添 加")]):t._e(),t.userRightEditable&&!t.showArchivedRecords?s("el-button",{staticClass:"operation-editable",attrs:{type:"primary"},on:{click:t.deleteRecord}},[t._v("删 除")]):t._e()],1)]),s("div",{staticClass:"section"},[s("div",{staticClass:"list-table"},[s("table",[s("tbody",[s("tr",[s("th",{attrs:{width:"4%"}},[s("div",[s("span",[t._v("#")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("分公司单元")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("班组单元")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("岗位单元（编号）")])])]),s("th",{attrs:{width:"8%"}},[s("div",[s("span",[t._v("填写人")])])]),s("th",{attrs:{width:"8%"}},[s("div",[s("span",[t._v("审核人")])])]),s("th",{attrs:{width:"18%"}},[s("div",[s("span",[t._v("辨识时间")])])]),s("th",{attrs:{width:"18%"}},[s("div",[s("span",[t._v("评估时间")])])]),s("th",{attrs:{width:"8%"}},[s("div",[s("span",[t._v("操作")])])])]),t._l(t.list,function(e,i){return s("tr",{key:i,attrs:{align:"center"}},[s("td",[s("el-checkbox",{attrs:{size:"medium","true-label":e.ResultMainID},model:{value:t.idList[i],callback:function(e){t.$set(t.idList,i,e)},expression:"idList[index]"}})],1),s("td",{attrs:{title:e.sectionName1}},[t._v(t._s(e.sectionName1))]),s("td",{attrs:{title:e.sectionName2}},[t._v(t._s(e.sectionName2))]),s("td",{attrs:{title:e.sectionName3+"("+e.sectionNum+")"}},[t._v(t._s(e.sectionName3+"("+e.sectionNum+")"))]),s("td",{attrs:{title:e.FillFormPersonName}},[t._v(t._s(e.FillFormPersonName))]),s("td",{attrs:{title:e.CheckPersonName}},[t._v(t._s(e.CheckPersonName))]),s("td",{attrs:{title:t.$moment(e.CreateTime).format("YYYY-MM-DD HH:mm:ss")}},[t._v("\n                  "+t._s(t.$moment(e.CreateTime).format("YYYY-MM-DD HH:mm:ss"))+"\n                ")]),s("td",{attrs:{title:t.$moment(e.AssessTime).format("YYYY-MM-DD HH:mm:ss")}},[t._v("\n                  "+t._s(t.$moment(e.AssessTime).format("YYYY-MM-DD HH:mm:ss"))+"\n                ")]),s("td",[s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.showDetailDialog(e.ResultMainID)}}},[t._v("详细")]),t.userRightEditable&&t.checkAuth(e.sectionInst1,e.sectionInst2)&&!t.showArchivedRecords?s("el-button",{staticClass:"operation-editable",attrs:{type:"text"},on:{click:function(s){return t.showEditDialog(e.ResultMainID)}}},[t._v("修改\n                  ")]):t._e()],1)])})],2)])])]),s("div",{staticClass:"section"},[s("div",{staticClass:"list-pagination"},[t.pageNum>0?s("el-pagination",{attrs:{background:"","page-size":"10",layout:"prev, pager, next","current-page":t.pageIndex,total:10*t.pageNum},on:{"current-change":t.updateListTable}}):s("div",{staticClass:"list-hint"},[t._v("提示：列表中无数据")])],1)])])]),s("div",{staticClass:"pop-dialog"},[s("add-dialog"),s("edit-dialog"),s("detail-dialog")],1)],1)},a=[],l=(s("c5f6"),s("ac6a"),s("5df3"),s("cebc")),n=s("d257"),r=s("3a0b"),o=s("2f62"),c=s("2cdc"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"add-dialog fullscreen-dialog"},[s("el-dialog",{attrs:{title:"添加LEC评估结果",visible:t.visible,modal:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,fullscreen:!0},on:{"update:visible":function(e){t.visible=e}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dialog-wrapper"},[s("div",{staticClass:"section"},[s("div",{staticClass:"list-filter"},[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    分公司：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-select",{attrs:{disabled:t.addClicked},on:{change:function(e){return t.getSectionList(2,t.context.sectionID1)}},model:{value:t.context.sectionID1,callback:function(e){t.$set(t.context,"sectionID1",e)},expression:"context.sectionID1"}},t._l(t.sectionList1_,function(t,e){return s("el-option",{key:e,attrs:{value:t.sectionID,label:t.sectionName}})}),1)],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    班组：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-select",{attrs:{disabled:t.addClicked},on:{change:function(e){return t.getSectionList(3,t.context.sectionID2)}},model:{value:t.context.sectionID2,callback:function(e){t.$set(t.context,"sectionID2",e)},expression:"context.sectionID2"}},t._l(t.sectionList2_,function(t,e){return s("el-option",{key:e,attrs:{value:t.sectionID,label:t.sectionName}})}),1)],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    岗位单元：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-select",{attrs:{disabled:t.addClicked},on:{change:function(e){return t.getDarkFlameMaster(t.context.sectionID3)}},model:{value:t.context.sectionID3,callback:function(e){t.$set(t.context,"sectionID3",e)},expression:"context.sectionID3"}},t._l(t.sectionList3,function(t,e){return s("el-option",{key:e,attrs:{value:t.sectionID,label:t.sectionName}})}),1)],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    唯一性编号：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{value:t.context.sectionNum,readonly:""}})],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    辨识时间：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-select",{attrs:{disabled:t.addClicked},model:{value:t.context.DangerFactorMainID,callback:function(e){t.$set(t.context,"DangerFactorMainID",e)},expression:"context.DangerFactorMainID"}},t._l(t.identList,function(t,e){return s("el-option",{key:e,attrs:{value:t.DangerFactorMainID,label:t.IdentificationTime}})}),1)],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    填写人：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{value:t.user.userName,readonly:""}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    审核人：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-select",{attrs:{readonly:t.addClicked,filterable:""},model:{value:t.context.CheckPerson,callback:function(e){t.$set(t.context,"CheckPerson",e)},expression:"context.CheckPerson"}},t._l(t.employees,function(t,e){return s("el-option",{key:e,attrs:{value:t.EmployeeNum,label:t.EmployeeAlias}})}),1)],1)],1)],1),t.addClicked?t._e():s("el-row",{staticClass:"operation",staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{disabled:t.addClicked||!t.contextCompleted(),type:"primary"},on:{click:t.addResultMain}},[t._v("添 加")]),s("el-button",{attrs:{type:"danger"},on:{click:function(e){t.visible=!1}}},[t._v("关 闭")])],1)],1)]),t.addClicked?s("div",{staticClass:"section"},[s("div",{staticClass:"list-table"},[s("table",[s("tbody",[s("tr",[s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("作业活动")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("第一类危险源")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("第二类危险源")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("事故类别")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("L")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("E")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("C")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("D")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("可能性（L）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("暴露频度（E）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("伤害度（C）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("风险等级（D）")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("类型")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("现有控制措施")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("拟定控制措施")])])])]),t._l(t.resultList,function(e,i){return s("tr",{key:i,attrs:{align:"center"}},[s("td",{attrs:{title:e.AEName}},[t._v(t._s(e.AEName))]),s("td",{attrs:{title:e.FirstLevelDanger}},[t._v(t._s(e.FirstLevelDanger))]),s("td",{attrs:{title:e.DangerFactorName}},[t._v(t._s(e.DangerFactorName))]),s("td",{attrs:{title:e.AccidentCategory}},[t._v(t._s(e.AccidentCategory)+"\n                  ")]),s("td",{attrs:{title:e.LValue}},[s("el-select",{on:{change:function(e){return t.getLevelInfo(i,"L")}},model:{value:e.LValue,callback:function(s){t.$set(e,"LValue",s)},expression:"record.LValue"}},t._l(t.lecValues.L,function(t,e){return s("el-option",{key:e,attrs:{value:t,label:t}})}),1)],1),s("td",{attrs:{title:e.EValue}},[s("el-select",{on:{change:function(e){return t.getLevelInfo(i,"E")}},model:{value:e.EValue,callback:function(s){t.$set(e,"EValue",s)},expression:"record.EValue"}},t._l(t.lecValues.E,function(t,e){return s("el-option",{key:e,attrs:{value:t,label:t}})}),1)],1),s("td",{attrs:{title:e.CValue}},[s("el-select",{on:{change:function(e){return t.getLevelInfo(i,"C")}},model:{value:e.CValue,callback:function(s){t.$set(e,"CValue",s)},expression:"record.CValue"}},t._l(t.lecValues.C,function(t,e){return s("el-option",{key:e,attrs:{value:t,label:t}})}),1)],1),s("td",{attrs:{title:t.trimDValue(e.DValue)}},[t._v(t._s(t.trimDValue(e.DValue)))]),s("td",{attrs:{title:t.getDesc("L",e.LValue)}},[t._v("\n                      "+t._s(t.getDesc("L",e.LValue))+"\n")]),s("td",{attrs:{title:t.getDesc("E",e.EValue)}},[t._v("\n                      "+t._s(t.getDesc("E",e.EValue))+"\n")]),s("td",{attrs:{title:t.getDesc("C",e.CValue)}},[t._v("\n                      "+t._s(t.getDesc("C",e.CValue))+"\n")]),s("td",{attrs:{title:e.DDescription}},[s("div",{staticClass:"desc-wrapper",style:{background:e.DLevel?e.DLevelColor:"white",color:e.DLevel?"#FFFF00"===e.DLevelColor?"black":"white":"red"}},[t._v("\n                      "+t._s(e.DDescription)+"\n                    ")])]),s("td",{attrs:{title:e.Type}},[s("el-select",{attrs:{disabled:t.addDetailClicked},model:{value:e.Type,callback:function(s){t.$set(e,"Type",s)},expression:"record.Type"}},[s("el-option",{key:"0",attrs:{value:"0",label:"管理型"}}),s("el-option",{key:"1",attrs:{value:"1",label:"改善型"}})],1)],1),s("td",{attrs:{title:e.ExistingMeasure}},[s("el-input",{attrs:{disabled:t.addDetailClicked},model:{value:e.ExistingMeasure,callback:function(s){t.$set(e,"ExistingMeasure",s)},expression:"record.ExistingMeasure"}})],1),s("td",{attrs:{title:e.ActivityMeasure}},[s("el-input",{attrs:{disabled:t.addDetailClicked},model:{value:e.ActivityMeasure,callback:function(s){t.$set(e,"ActivityMeasure",s)},expression:"record.ActivityMeasure"}})],1)])})],2)])])]):t._e(),t.addClicked?s("div",{staticClass:"section"},[s("div",{staticClass:"list-filter"},[s("el-row",{staticStyle:{"text-align":"right",margin:"0 1.5em 1.5em 1.5em"}},[s("el-button",{attrs:{disabled:!t.enableToSubmit||t.addDetailClicked,type:"primary"},on:{click:t.addResultDetail}},[t._v("添 加")]),s("el-button",{attrs:{type:"danger"},on:{click:function(e){t.visible=!1}}},[t._v("关 闭")])],1)],1)]):t._e()])])],1)])},d=[],v=(s("55dd"),s("28a5"),s("ae03")),p=(s("456d"),{data:function(){return{resultList:[],context:{DangerFactorMainID:null,CheckPerson:null},visible:!1,loading:!1,resultListSort:function(t,e){return t.AEInfoID===e.AEInfoID?t.FirstLevelDanger===e.FirstLevelDanger?t.ActDangerFactorID-e.ActDangerFactorID:t.FirstLevelDanger.localeCompare(e.FirstLevelDanger,"zh-CN"):t.AEInfoID-e.AEInfoID},rules:{L:{},E:{},C:{},D:[]}}},created:function(){this.getRiskLevelRules()},computed:Object(l["a"])({lecValues:function(){var t=function(t,e){return Number(t)>Number(e)?1:-1};return{L:Object.keys(this.rules.L).sort(t),E:Object.keys(this.rules.E).sort(t),C:Object.keys(this.rules.C).sort(t)}}},Object(o["b"])(["user","employees","accidents"]),{enableToSubmit:function(){return this.resultList.filter(function(t){return t.LLevel&&t.ELevel&&t.CLevel&&t.DLevel}).length===this.resultList.length}}),watch:{visible:function(t){var e=this;t||(Object.keys(this.context).forEach(function(t){e.context[t]=null}),this.$emit("data-changed"))}},methods:{getDesc:function(t,e){return this.rules[t][e+""]?this.rules[t][e+""].desc:""},getRiskLevelRules:function(){var t=this;v["c"].get("".concat(v["a"].SECTION_EVALUATION,"/lec-risk-rules")).then(function(e){t.loading=!1,t.rules.D=e.list,e.factorList.forEach(function(e){var s=["L","E","C"][Number(e.FactorNum)-1];t.rules[s][e.FactorValue+""]||(t.rules[s][e.FactorValue+""]={}),t.rules[s][e.FactorValue+""].desc=e.LevelDescription,t.rules[s][e.FactorValue+""].level=e.LevelID})})},trimDValue:function(t){return Number(t)?t.toFixed(2):t},getIdentList:function(t){var e=this;this.loading=!0,v["c"].get("".concat(v["a"].SECTION_EVALUATION,"/ident-list/").concat(t),function(t){e.loading=!1,e.identList=t.list})},getLevelInfo:function(t,e){var s=this.resultList[t][e+"Value"];if(s){if(isNaN(s))this.$set(this.resultList[t],e+"Description","输入值应为数字！"),this.$set(this.resultList[t],e+"Level",""),this.$set(this.resultList[t],"DDescription",""),this.$set(this.resultList[t],"DLevelColor",""),this.$set(this.resultList[t],"DLevel",""),this.$set(this.resultList[t],"DValue","");else if(this.rules[e].hasOwnProperty(s)&&(this.$set(this.resultList[t],e+"Description",this.rules[e][s].desc),this.$set(this.resultList[t],e+"Level",this.rules[e][s].level)),3===[this.resultList[t].LLevel,this.resultList[t].ELevel,this.resultList[t].CLevel].filter(function(t){return t}).length){var i=[this.resultList[t].LValue,this.resultList[t].EValue,this.resultList[t].CValue].reduce(function(t,e){return Number(t)*Number(e)}),a=this.rules["D"].filter(function(t){return i>=t.RiskLevelMin&&i<t.RiskLevelMax});this.$set(this.resultList[t],"DValue",i),1===a.length?(this.$set(this.resultList[t],"DDescription",a[0].RiskLevelDescription),this.$set(this.resultList[t],"DLevelColor",a[0].RiskLevelColor),this.$set(this.resultList[t],"DLevel",a[0].RiskLevelID)):(this.$set(this.resultList[t],"DLevel",null),this.$set(this.resultList[t],"DDescription","D值超出范围！"))}}else this.$set(this.resultList[t],e+"Description",""),this.$set(this.resultList[t],e+"Level",""),this.$set(this.resultList[t],"DDescription",""),this.$set(this.resultList[t],"DLevelColor",""),this.$set(this.resultList[t],"DLevel",""),this.$set(this.resultList[t],"DValue","")},updateDialog:function(t){var e=this;this.id=t,this.context.dangerFactorMainID=this.id,this.context.CheckPersonNum=this.user.userId,this.context.AssessTime=new Date,this.loading=!0,v["c"].get(v["a"].SECTION_EVALUATION+"/lec-result-main/".concat(this.id),function(t){e.context=t.record;var s=e.accidents.map(function(t){return t.accidentID+""}),i=e.accidents.map(function(t){return t.accidentName});t.resultList.forEach(function(t){t.AccidentCategory=t.AccidentCategorySet.split(",").map(function(t){return i[s.indexOf(t)]}).join("，"),t.IsUnderControl||(t.IsUnderControl="1")}),e.resultList=t.resultList.sort(e.resultListSort),e.$nextTick(function(){e.loading=!1})})}}}),h={name:"AddDialog",mixins:[p],data:function(){return{addClicked:!1,addDetailClicked:!1,sectionList1:[],sectionList2:[],sectionList3:[],identList:[]}},computed:{sectionList1_:function(){var t=this;return this.user&&-1===n["g"].indexOf(this.user.inst1)?this.sectionList1.filter(function(e){return[t.user.inst1,t.user.inst2].indexOf(e.sectionNum)>-1}):this.sectionList1},sectionList2_:function(){var t=this;return this.user&&-1===n["g"].indexOf(this.user.inst1)&&this.user.inst2?this.sectionList2.filter(function(e){return e.sectionNum===t.user.inst1}):this.sectionList2}},watch:{visible:function(t){t||this.addClicked&&(this.addClicked=!1,this.addDetailClicked=!1,c["a"].$emit("data-changed"))},sectionList1:function(t){this.context.sectionID1=null,this.sectionList2=[]},sectionList2:function(t){this.context.sectionID2=null,this.sectionList3=[]},sectionList3:function(t){this.context.sectionID3=null,this.context.sectionNum=null,this.identList=[]},identList:function(t){this.context.dangerFactorMainID=null}},methods:{contextCompleted:function(){var t=this.context;return t.sectionID1&&t.sectionID2&&t.sectionID3&&t.DangerFactorMainID},getSectionList:function(t,e){var s=this;this.loading=!0,v["c"].get("".concat(v["a"].SECTION_IDENT,"/section-list/").concat(e||0),function(e){switch(s.loading=!1,s["sectionList"+t]=e.list,t){case 1:s.context.sectionID1=null,s.sectionList2=[],s.context.sectionID2=null,s.sectionList3=[],s.context.sectionID3=null,s.context.sectionNum=null,s.identList=[],s.context.DangerFactorMainID=null;break;case 2:s.context.sectionID2=null,s.sectionList3=[],s.context.sectionID3=null,s.context.sectionNum=null,s.identList=[],s.context.DangerFactorMainID=null;break;case 3:s.context.sectionID3=null,s.context.sectionNum=null,s.context.DangerFactorMainID=null;break}})},getDarkFlameMaster:function(t){var e=this;this.loading=!0,this.context.sectionNum=this.sectionList3.filter(function(e){return e.sectionID===t})[0].sectionNum,v["c"].get("".concat(v["a"].SECTION_EVALUATION,"/lec-section-ident/").concat(t),function(t){e.loading=!1,e.identList=t.list})},addResultMain:function(){var t=this;this.loading=!0,this.context.FillFormPerson=this.user.userId,this.context.IsArchived="0",this.context.DangerFactorFatherID=this.context.sectionID3,v["c"].postJson(v["a"].SECTION_EVALUATION+"/lec-result-main",this.context,function(e){var s=t.accidents.map(function(t){return t.accidentID+""}),i=t.accidents.map(function(t){return t.accidentName});e.resultList.forEach(function(t){t.AccidentCategory=t.AccidentCategorySet.split(",").map(function(t){return i[s.indexOf(t)]}).join("，"),t.IsUnderControl="1"}),t.resultList=e.resultList.sort(t.resultListSort),t.context.ResultMainID=e.resultMainID,t.addClicked=!0,t.loading=!1})},addResultDetail:function(){var t=this;this.loading=!0,this.resultList.forEach(function(e){e.ResultMainID=t.context.ResultMainID}),v["c"].postJson(v["a"].SECTION_EVALUATION+"/lec-result-detail",this.resultList,function(e){"ok"===e.status&&(t.$message.success("提交成功！"),t.addDetailClicked=!0,t.enableToSubmit=!1),t.loading=!1})}},created:function(){var t=this;c["a"].$on("show-add-eval",function(){t.visible=!0,t.loading=!0,t.context.CheckPerson=t.user.userId,t.context.AssessTime=new Date,t.getSectionList(1)})}},f=h,m=s("2877"),g=Object(m["a"])(f,u,d,!1,null,null,null),b=g.exports,D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"add-dialog fullscreen-dialog"},[s("el-dialog",{attrs:{title:"修改LEC评估结果",visible:t.visible,modal:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,fullscreen:!0},on:{"update:visible":function(e){t.visible=e}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dialog-wrapper"},[s("div",{staticClass:"section"},[s("div",{staticClass:"list-filter"},[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    分公司：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.sectionName1}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    班组：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.sectionName2}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    岗位单元：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.sectionName3}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    唯一性编号：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{value:t.context.sectionNum,readonly:""}})],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    辨识时间：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss",readonly:"",value:t.context.CreateTime,clearable:""}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    填写人：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{value:t.user.userName,readonly:""}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    审核人：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-select",{attrs:{filterable:""},model:{value:t.context.CheckPerson,callback:function(e){t.$set(t.context,"CheckPerson",e)},expression:"context.CheckPerson"}},t._l(t.employees,function(t,e){return s("el-option",{key:e,attrs:{value:t.EmployeeNum,label:t.EmployeeAlias}})}),1)],1)],1)],1)],1)]),s("div",{staticClass:"section"},[s("div",{staticClass:"list-table"},[s("table",[s("tbody",[s("tr",[s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("作业活动")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("第一类危险源")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("第二类危险源")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("事故类别")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("L")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("E")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("C")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("D")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("可能性（L）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("暴露频度（E）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("伤害度（C）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("风险等级（D）")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("类型")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("现有控制措施")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("拟定控制措施")])])])]),t._l(t.resultList,function(e,i){return s("tr",{key:i,attrs:{align:"center"}},[s("td",{attrs:{title:e.AEName}},[t._v(t._s(e.AEName))]),s("td",{attrs:{title:e.FirstLevelDanger}},[t._v(t._s(e.FirstLevelDanger))]),s("td",{attrs:{title:e.DangerFactorName}},[t._v(t._s(e.DangerFactorName))]),s("td",{attrs:{title:e.AccidentCategory}},[t._v(t._s(e.AccidentCategory))]),s("td",{attrs:{title:e.LValue}},[s("el-select",{on:{change:function(e){return t.getLevelInfo(i,"L")}},model:{value:e.LValue,callback:function(s){t.$set(e,"LValue",s)},expression:"record.LValue"}},t._l(t.lecValues.L,function(t,e){return s("el-option",{key:e,attrs:{value:t,label:t}})}),1)],1),s("td",{attrs:{title:e.EValue}},[s("el-select",{on:{change:function(e){return t.getLevelInfo(i,"E")}},model:{value:e.EValue,callback:function(s){t.$set(e,"EValue",s)},expression:"record.EValue"}},t._l(t.lecValues.E,function(t,e){return s("el-option",{key:e,attrs:{value:t,label:t}})}),1)],1),s("td",{attrs:{title:e.CValue}},[s("el-select",{on:{change:function(e){return t.getLevelInfo(i,"C")}},model:{value:e.CValue,callback:function(s){t.$set(e,"CValue",s)},expression:"record.CValue"}},t._l(t.lecValues.C,function(t,e){return s("el-option",{key:e,attrs:{value:t,label:t}})}),1)],1),s("td",{attrs:{title:t.trimDValue(e.DValue)}},[t._v(t._s(t.trimDValue(e.DValue)))]),s("td",{attrs:{title:t.getDesc("L",e.LValue)}},[t._v("\n                      "+t._s(t.getDesc("L",e.LValue))+"\n")]),s("td",{attrs:{title:t.getDesc("E",e.EValue)}},[t._v("\n                      "+t._s(t.getDesc("E",e.EValue))+"\n")]),s("td",{attrs:{title:t.getDesc("C",e.CValue)}},[t._v("\n                      "+t._s(t.getDesc("C",e.CValue))+"\n")]),s("td",{attrs:{title:e.DDescription}},[s("div",{staticClass:"desc-wrapper",style:{background:e.DLevel?e.DLevelColor:"white",color:e.DLevel?"#FFFF00"===e.DLevelColor?"black":"white":"red"}},[t._v("\n                      "+t._s(e.DDescription)+"\n                    ")])]),s("td",{attrs:{title:e.Type}},[s("el-select",{model:{value:e.Type,callback:function(s){t.$set(e,"Type",s)},expression:"record.Type"}},[s("el-option",{key:"0",attrs:{value:"0",label:"管理型"}}),s("el-option",{key:"1",attrs:{value:"1",label:"改善型"}})],1)],1),s("td",{attrs:{title:e.ExistingMeasure}},[s("el-input",{model:{value:e.ExistingMeasure,callback:function(s){t.$set(e,"ExistingMeasure",s)},expression:"record.ExistingMeasure"}})],1),s("td",{attrs:{title:e.ActivityMeasure}},[s("el-input",{model:{value:e.ActivityMeasure,callback:function(s){t.$set(e,"ActivityMeasure",s)},expression:"record.ActivityMeasure"}})],1)])})],2)])])]),s("div",{staticClass:"list-filter"},[s("el-row",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{disabled:!t.enableToSubmit,type:"primary"},on:{click:t.submitResultDetail}},[t._v("保 存")]),s("el-button",{attrs:{type:"danger"},on:{click:function(e){t.visible=!1}}},[t._v("关 闭")])],1)],1)])])],1)])},_=[],L={name:"EditDialog",mixins:[p],data:function(){return{id:"",idList:[],hasChanges:!1}},watch:{visible:function(t){t||this.hasChanges&&(this.hasChanges=!1,c["a"].$emit("data-changed"))}},methods:{submitResultDetail:function(){var t=this;this.loading=!0,this.context.FillFormPerson=this.user.userId,this.resultList.forEach(function(e){e.ResultMainID||(e.ResultMainID=t.id)});var e=this.resultList.filter(function(t){return t.ResultDetailID}),s=this.resultList.filter(function(t){return!t.ResultDetailID}),i=[n["c"].putJson(n["a"].SECTION_EVALUATION+"/lec-result-main",this.context)];s.length>0&&i.push(n["c"].postJson(n["a"].SECTION_EVALUATION+"/lec-result-detail",s)),e.length>0&&i.push(n["c"].putJson(n["a"].SECTION_EVALUATION+"/lec-result-detail",e)),Promise.all(i).then(function(e){t.loading=!1,t.hasChanges=!0,t.$message.success("提交成功！"),i.length>=2&&s.length>0&&s.forEach(function(t,s){t.ResultDetailID=e[1].idList[s]})})}},mounted:function(){var t=this;c["a"].$on("show-edit-eval",function(e){t.idList=e.idList,t.visible=!0,t.updateDialog(e.id)})}},C=L,x=Object(m["a"])(C,D,_,!1,null,"68197622",null),y=x.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"add-dialog fullscreen-dialog"},[s("el-dialog",{attrs:{title:"查看LEC评估结果",visible:t.visible,modal:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,fullscreen:!0},on:{"update:visible":function(e){t.visible=e}}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dialog-wrapper"},[s("div",{staticClass:"section"},[s("div",{staticClass:"list-filter"},[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    分公司：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.sectionName1}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    班组：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.sectionName2}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    岗位单元：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.sectionName3}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    唯一性编号：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{value:t.context.sectionNum,readonly:""}})],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    辨识时间：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss",value:t.context.CreateTime,readonly:""}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    填写人：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{value:t.context.FillFormPersonName,readonly:""}})],1)],1),s("el-col",{attrs:{span:6}},[s("el-col",{staticClass:"filter-label",attrs:{span:7}},[t._v("\n                    审核人：\n                  ")]),s("el-col",{attrs:{span:15}},[s("el-input",{attrs:{readonly:"",value:t.context.CheckPersonName}})],1)],1)],1)],1)]),s("div",{staticClass:"section"},[s("div",{staticClass:"list-table"},[s("table",[s("tbody",[s("tr",[s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("作业活动")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("第一类危险源")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("第二类危险源")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("事故类别")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("L")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("E")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("C")])])]),s("th",{attrs:{width:"10%"}},[s("div",[s("span",[t._v("D")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("可能性（L）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("暴露频度（E）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("伤害度（C）")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("风险等级（D）")])])]),s("th",{attrs:{width:"15%"}},[s("div",[s("span",[t._v("类型")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("现有控制措施")])])]),s("th",{attrs:{width:"20%"}},[s("div",[s("span",[t._v("拟定控制措施")])])])]),t._l(t.resultList,function(e,i){return s("tr",{key:i,attrs:{align:"center"}},[s("td",{attrs:{title:e.AEName}},[t._v(t._s(e.AEName))]),s("td",{attrs:{title:e.FirstLevelDanger}},[t._v(t._s(e.FirstLevelDanger))]),s("td",{attrs:{title:e.DangerFactorName}},[t._v(t._s(e.DangerFactorName))]),s("td",{attrs:{title:e.AccidentCategory}},[t._v(t._s(e.AccidentCategory))]),s("td",{attrs:{title:e.LValue}},[t._v(t._s(e.LValue))]),s("td",{attrs:{title:e.EValue}},[t._v(t._s(e.EValue))]),s("td",{attrs:{title:e.CValue}},[t._v(t._s(e.CValue))]),s("td",{attrs:{title:t.trimDValue(e.DValue)}},[t._v(t._s(t.trimDValue(e.DValue)))]),s("td",{attrs:{title:t.getDesc("L",e.LValue)}},[t._v("\n                      "+t._s(t.getDesc("L",e.LValue))+"\n")]),s("td",{attrs:{title:t.getDesc("E",e.EValue)}},[t._v("\n                      "+t._s(t.getDesc("E",e.EValue))+"\n")]),s("td",{attrs:{title:t.getDesc("C",e.CValue)}},[t._v("\n                      "+t._s(t.getDesc("C",e.CValue))+"\n")]),s("td",{attrs:{title:e.DDescription}},[s("div",{staticClass:"desc-wrapper",style:{background:e.DLevel?e.DLevelColor:"white",color:e.DLevel?"#FFFF00"===e.DLevelColor?"black":"white":"red"}},[t._v("\n                      "+t._s(e.DDescription)+"\n                    ")])]),s("td",{attrs:{title:e.Type}},[s("el-select",{attrs:{readonly:""},model:{value:e.Type,callback:function(s){t.$set(e,"Type",s)},expression:"record.Type"}},[s("el-option",{key:"0",attrs:{value:"0",label:"管理型"}}),s("el-option",{key:"1",attrs:{value:"1",label:"改善型"}})],1)],1),s("td",{attrs:{title:e.ExistingMeasure}},[s("el-input",{attrs:{readonly:""},model:{value:e.ExistingMeasure,callback:function(s){t.$set(e,"ExistingMeasure",s)},expression:"record.ExistingMeasure"}})],1),s("td",{attrs:{title:e.ActivityMeasure}},[s("el-input",{attrs:{readonly:""},model:{value:e.ActivityMeasure,callback:function(s){t.$set(e,"ActivityMeasure",s)},expression:"record.ActivityMeasure"}})],1)])})],2)])])]),s("div",{staticClass:"list-filter"},[s("el-row",{staticStyle:{"text-align":"right",margin:"0 1.5em 1.5em 1.5em"}},[s("el-button",{staticStyle:{float:"left"},attrs:{disabled:0===t.idList.indexOf(t.id),type:"primary"},on:{click:function(e){t.updateDialog(t.idList[t.idList.indexOf(t.id)-1])}}},[t._v("上一条\n              ")]),s("el-button",{staticStyle:{float:"left"},attrs:{disabled:t.idList.indexOf(t.id)===t.idList.length-1,type:"primary"},on:{click:function(e){t.updateDialog(t.idList[t.idList.indexOf(t.id)+1])}}},[t._v("下一条\n              ")]),s("el-button",{attrs:{type:"danger"},on:{click:function(e){t.visible=!1}}},[t._v("关 闭")])],1)],1)])])],1)])},I=[],w={name:"DetailDialog",mixins:[p],data:function(){return{id:"",idList:[]}},mounted:function(){var t=this;c["a"].$on("show-detail-eval",function(e){t.id=e.id,t.idList=e.idList,t.visible=!0,t.updateDialog(t.id)})}},E=w,N=Object(m["a"])(E,k,I,!1,null,null,null),V=N.exports,A={name:"App",store:r["a"],components:{AddDialog:b,EditDialog:y,DetailDialog:V},data:function(){return{list:[],idList:[],pageNum:0,pageIndex:1,conditions:"",loading:!1,params:[{label:"分公司单元：",type:"select",model:"sectionID1"},{label:"岗位单元：",type:"select",model:"sectionID3"},{label:"岗位编号：",type:"text",model:"sectionNum"},{label:"辨识时间：",type:"time",model:"CreateTime"},{label:"评估时间：",type:"time",model:"AssessTime"},{label:"是否归档：",type:"select",model:"IsArchived"}],sectionList:[],showArchivedRecords:!1,userRightEditable:!1}},computed:Object(l["a"])({},Object(o["b"])(["user","employees","institutions"])),methods:{checkAuth:function(t,e){if(n["g"].indexOf(this.user.inst1)>-1)return!0;var s=this.user.inst2;return s?e===this.user.inst1:t===this.user.inst1},filter:function(){this.conditions=Object(n["e"])(this.params),this.updateListTable()},showAddDialog:function(){c["a"].$emit("show-add-eval",{})},showEditDialog:function(t){c["a"].$emit("show-edit-eval",{id:t,idList:this.list.map(function(t){return t.ResultMainID})})},showDetailDialog:function(t){c["a"].$emit("show-detail-eval",{id:t,idList:this.list.map(function(t){return t.ResultMainID})})},updateListTable:function(t,e){var s=this;void 0!==t&&(this.pageIndex=t),void 0!==e&&(this.conditions=e),this.loading=!0,n["c"].post(n["a"].SECTION_EVALUATION+"/lec-result-list",{pageIndex:this.pageIndex,conditions:this.conditions},function(t){s.list=t.list,s.pageNum=t.pageNum,s.idList=s.list.map(function(t){return""}),s.loading=!1,s.showArchivedRecords="1"===s.params[5].value})},archiveRecord:function(){var t=this,e=this.idList.filter(function(t){return t}),s=this.list.map(function(t){return t.ResultMainID});0!==e.map(function(t){return s.indexOf(t)}).filter(function(e){return t.checkAuth(t.list[e].sectionInst1,t.list[e].sectionInst2)}).length?e.length>0?this.$confirm("确认归档吗？").then(function(){t.loading=!0,Promise.all(e.map(function(t){return n["c"].put("".concat(n["a"].SECTION_PARTITION,"/section-archive"),{id:t,level:7})})).then(function(e){t.loading=!1,t.$message.success("归档成功！"),t.updateListTable()})}):this.$message.warning("请先选择几条记录再归档。"):this.$message.warning("您没有权限归档权限中的部分纪录！")},deleteRecord:function(){var t=this,e=this.idList.filter(function(t){return t}),s=this.list.map(function(t){return t.ResultMainID});0!==e.map(function(t){return s.indexOf(t)}).filter(function(e){return t.checkAuth(t.list[e].sectionInst1,t.list[e].sectionInst2)}).length?e.length>0?this.$confirm("确认删除吗？").then(function(){t.loading=!0,Promise.all(e.map(function(t){return n["c"].delete("".concat(n["a"].SECTION_PARTITION,"/section-delete"),{id:t,level:7})})).then(function(e){t.loading=!1,t.$message.success("删除成功！"),t.updateListTable()})}):this.$message.warning("请先选择几条记录再删除。"):this.$message.warning("您没有权限删除权限中的部分纪录！")},exportRecord:function(){var t=this;this.params[0].value&&(this.params[0].valueCN=this.sectionList.filter(function(e){return e.sectionID===Number(t.params[0].value)})[0].sectionName),this.params[1].value&&(this.params[1].valueCN=this.sectionList.filter(function(e){return e.sectionID===Number(t.params[1].value)})[0].sectionName),this.params[5].value&&(this.params[5].valueCN=["未归档","已归档"][Number(this.params[5].value)]),n["c"].formSubmit(n["a"].SECTION_EVALUATION+"/export",{idList:this.idList.filter(function(t){return t}).join(","),conditions:this.conditions,conditionsCN:Object(n["f"])(this.params)})},beforeRouteLeave:function(t,e,s){this.$destroy(),s()}},created:function(){var t=this;c["a"].$on("data-changed",function(){t.updateListTable()}),this.updateListTable(),n["c"].get(n["a"].SECTION_IDENT+"/all-section",function(e){t.sectionList=e.list}),this.$store.dispatch("updateUser"),this.$store.dispatch("updateEmployees"),this.$store.dispatch("updateInsts"),this.$store.dispatch("updateAccidents"),this.userRightEditable=Object(n["d"])("030300")},mounted:function(){}},$=A,T=(s("8bd7"),Object(m["a"])($,i,a,!1,null,"3c483dcc",null));e["default"]=T.exports},ed33:function(t,e,s){s("014b"),t.exports=s("584a").Object.getOwnPropertySymbols},fde4:function(t,e,s){s("bf90");var i=s("584a").Object;t.exports=function(t,e){return i.getOwnPropertyDescriptor(t,e)}}}]);